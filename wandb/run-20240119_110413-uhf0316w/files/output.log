01/19/2024 11:04:21 - INFO - __main__ - ***** Running training *****
01/19/2024 11:04:21 - INFO - __main__ -   Num examples = 11
01/19/2024 11:04:21 - INFO - __main__ -   Num Epochs = 8
01/19/2024 11:04:21 - INFO - __main__ -   Instantaneous batch size per device = 2
01/19/2024 11:04:21 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 8
01/19/2024 11:04:21 - INFO - __main__ -   Gradient Accumulation steps = 4
01/19/2024 11:04:21 - INFO - __main__ -   Total optimization steps = 15
Steps:   0%|                                                                                                                                                                                        | 0/15 [00:00<?, ?it/s]C:\Users\30661\.conda\envs\torchgpu\lib\site-packages\diffusers\configuration_utils.py:139: FutureWarning: Accessing config attribute `num_train_timesteps` directly via 'DDPMScheduler' object attribute is deprecated. Please access 'num_train_timesteps' over 'DDPMScheduler's config object instead, e.g. 'scheduler.config.num_train_timesteps'.
  deprecate("direct config name access", "1.0.0", deprecation_message, standard_warn=False)
Steps:   0%|                                                                                                                                                              | 0/15 [00:06<?, ?it/s, lr=5e-6, step_loss=0.114]01/19/2024 11:04:27 - INFO - __main__ - Running validation...
 Generating 1 images with prompt: Transform the text in the image into Anny's style with a white background..
{'image_encoder'} was not found in config. Values will be initialized to default values.
                                                                                                                                                                                                                           Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of timbrooks/instruct-pix2pix.
{'timestep_spacing', 'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.                                                                                | 0/7 [00:00<?, ?it/s]
Loaded scheduler as EulerAncestralDiscreteScheduler from `scheduler` subfolder of timbrooks/instruct-pix2pix.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["id2label"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["bos_token_id"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["eos_token_id"]` will be overriden.
Loaded safety_checker as StableDiffusionSafetyChecker from `safety_checker` subfolder of timbrooks/instruct-pix2pix.
                                                                                                                                                                                                                           Loaded text_encoder as CLIPTextModel from `text_encoder` subfolder of timbrooks/instruct-pix2pix.
Loading pipeline components...:  57%|██████████████████████████████████████████████████████████████████████████████████████▊                                                                 | 4/7 [00:01<00:01,  2.68it/s]Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of timbrooks/instruct-pix2pix.
{'force_upcast', 'scaling_factor'} was not found in config. Values will be initialized to default values.████████████████████████████████████████▌                                           | 5/7 [00:01<00:00,  2.70it/s]
Loaded vae as AutoencoderKL from `vae` subfolder of timbrooks/instruct-pix2pix.
Loading pipeline components...: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.35it/s]
Loading pipeline components...: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  3.83it/s]
Steps:   0%|                                                                                                                                                             | 0/15 [00:18<?, ?it/s, lr=5e-6, step_loss=0.0328]01/19/2024 11:04:39 - INFO - __main__ - Running validation...
 Generating 1 images with prompt: Transform the text in the image into Anny's style with a white background..
{'image_encoder'} was not found in config. Values will be initialized to default values.
                                                                                                                                                                                                                           Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of timbrooks/instruct-pix2pix.
{'timestep_spacing', 'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.                                                                                | 0/7 [00:00<?, ?it/s]
Loaded scheduler as EulerAncestralDiscreteScheduler from `scheduler` subfolder of timbrooks/instruct-pix2pix.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["id2label"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["bos_token_id"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["eos_token_id"]` will be overriden.
Loaded safety_checker as StableDiffusionSafetyChecker from `safety_checker` subfolder of timbrooks/instruct-pix2pix.
                                                                                                                                                                                                                           Loaded text_encoder as CLIPTextModel from `text_encoder` subfolder of timbrooks/instruct-pix2pix.
Loading pipeline components...:  57%|██████████████████████████████████████████████████████████████████████████████████████▊                                                                 | 4/7 [00:00<00:00,  5.59it/s]Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of timbrooks/instruct-pix2pix.
{'force_upcast', 'scaling_factor'} was not found in config. Values will be initialized to default values.████████████████████████████████████████▌                                           | 5/7 [00:01<00:00,  4.44it/s]
Loaded vae as AutoencoderKL from `vae` subfolder of timbrooks/instruct-pix2pix.
Loading pipeline components...: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:01<00:00,  5.40it/s]
Loading pipeline components...: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:01<00:00,  5.65it/s]
Steps:   0%|                                                                                                                                                              | 0/15 [00:26<?, ?it/s, lr=5e-6, step_loss=0.151]01/19/2024 11:04:47 - INFO - __main__ - Running validation...
 Generating 1 images with prompt: Transform the text in the image into Anny's style with a white background..
{'image_encoder'} was not found in config. Values will be initialized to default values.
                                                                                                                                                                                                                           Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of timbrooks/instruct-pix2pix.
{'timestep_spacing', 'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.                                                                                | 0/7 [00:00<?, ?it/s]
Loaded scheduler as EulerAncestralDiscreteScheduler from `scheduler` subfolder of timbrooks/instruct-pix2pix.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["id2label"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["bos_token_id"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["eos_token_id"]` will be overriden.
Loaded safety_checker as StableDiffusionSafetyChecker from `safety_checker` subfolder of timbrooks/instruct-pix2pix.
                                                                                                                                                                                                                           Loaded text_encoder as CLIPTextModel from `text_encoder` subfolder of timbrooks/instruct-pix2pix.
Loading pipeline components...:  57%|██████████████████████████████████████████████████████████████████████████████████████▊                                                                 | 4/7 [00:00<00:00,  5.58it/s]Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of timbrooks/instruct-pix2pix.
{'force_upcast', 'scaling_factor'} was not found in config. Values will be initialized to default values.████████████████████████████████████████▌                                           | 5/7 [00:01<00:00,  4.52it/s]
Loaded vae as AutoencoderKL from `vae` subfolder of timbrooks/instruct-pix2pix.
Loading pipeline components...: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:01<00:00,  5.46it/s]
Loading pipeline components...: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:01<00:00,  5.72it/s]
C:\Users\30661\.conda\envs\torchgpu\lib\site-packages\transformers\deepspeed.py:23: FutureWarning: transformers.deepspeed module is deprecated and will be removed in a future version. Please import deepspeed modules directly from transformers.integrations
  warnings.warn(
Steps:   7%|█████████▉                                                                                                                                           | 1/15 [00:50<11:29, 49.28s/it, lr=5e-6, step_loss=0.0203]01/19/2024 11:05:11 - INFO - __main__ - Running validation...
 Generating 1 images with prompt: Transform the text in the image into Anny's style with a white background..
{'image_encoder'} was not found in config. Values will be initialized to default values.
                                                                                                                                                                                                                           Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of timbrooks/instruct-pix2pix.
{'timestep_spacing', 'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.                                                                                | 0/7 [00:00<?, ?it/s]
Loaded scheduler as EulerAncestralDiscreteScheduler from `scheduler` subfolder of timbrooks/instruct-pix2pix.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["id2label"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["bos_token_id"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["eos_token_id"]` will be overriden.
Loaded safety_checker as StableDiffusionSafetyChecker from `safety_checker` subfolder of timbrooks/instruct-pix2pix.
Loading pipeline components...:  57%|██████████████████████████████████████████████████████████████████████████████████████▊                                                                 | 4/7 [00:01<00:01,  2.28it/s]Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of timbrooks/instruct-pix2pix.
{'force_upcast', 'scaling_factor'} was not found in config. Values will be initialized to default values.████████████████████████████████████████▌                                           | 5/7 [00:02<00:01,  1.79it/s]
Loaded vae as AutoencoderKL from `vae` subfolder of timbrooks/instruct-pix2pix.
Loading pipeline components...: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:03<00:00,  2.13it/s]
[34m[1mwandb[39m[22m: [33mWARNING[39m Step only supports monotonically increasing values, use define_metric to set a custom x axis. For details see: https://wandb.me/define-metric█████████████████████████████████| 7/7 [00:03<00:00,  2.20it/s]
[34m[1mwandb[39m[22m: [33mWARNING[39m (User provided step: 1 is less than current step: 9. Dropping entry: {'train_loss': 0.07954243663698435, '_timestamp': 1705633510.3909013}).
validate1 1
Steps:   7%|██████████                                                                                                                                            | 1/15 [01:26<11:29, 49.28s/it, lr=5e-6, step_loss=0.046]01/19/2024 11:05:47 - INFO - __main__ - Running validation...
 Generating 1 images with prompt: Transform the text in the image into Anny's style with a white background..
{'image_encoder'} was not found in config. Values will be initialized to default values.
                                                                                                                                                                                                                           Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of timbrooks/instruct-pix2pix.
{'timestep_spacing', 'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.                                                                                | 0/7 [00:00<?, ?it/s]
Loaded scheduler as EulerAncestralDiscreteScheduler from `scheduler` subfolder of timbrooks/instruct-pix2pix.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["id2label"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["bos_token_id"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["eos_token_id"]` will be overriden.
Loaded safety_checker as StableDiffusionSafetyChecker from `safety_checker` subfolder of timbrooks/instruct-pix2pix.
Loading pipeline components...:  57%|██████████████████████████████████████████████████████████████████████████████████████▊                                                                 | 4/7 [00:02<00:01,  1.60it/s]Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of timbrooks/instruct-pix2pix.
{'force_upcast', 'scaling_factor'} was not found in config. Values will be initialized to default values.████████████████████████████████████████▌                                           | 5/7 [00:03<00:01,  1.36it/s]
Loaded vae as AutoencoderKL from `vae` subfolder of timbrooks/instruct-pix2pix.
Loading pipeline components...: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:04<00:00,  1.63it/s]
Loading pipeline components...: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:04<00:00,  1.73it/s]
Steps:  13%|████████████████████                                                                                                                                  | 2/15 [02:15<15:20, 70.80s/it, lr=5e-6, step_loss=0.141]01/19/2024 11:06:36 - INFO - __main__ - Running validation...
 Generating 1 images with prompt: Transform the text in the image into Anny's style with a white background..
{'image_encoder'} was not found in config. Values will be initialized to default values.
                                                                                                                                                                                                                           Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of timbrooks/instruct-pix2pix.
{'timestep_spacing', 'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.                                                                                | 0/7 [00:00<?, ?it/s]
Loaded scheduler as EulerAncestralDiscreteScheduler from `scheduler` subfolder of timbrooks/instruct-pix2pix.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["id2label"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["bos_token_id"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["eos_token_id"]` will be overriden.
Loaded safety_checker as StableDiffusionSafetyChecker from `safety_checker` subfolder of timbrooks/instruct-pix2pix.
                                                                                                                                                                                                                           Loaded text_encoder as CLIPTextModel from `text_encoder` subfolder of timbrooks/instruct-pix2pix.
Loading pipeline components...:  57%|██████████████████████████████████████████████████████████████████████████████████████▊                                                                 | 4/7 [00:02<00:01,  1.63it/s]Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of timbrooks/instruct-pix2pix.
Loading pipeline components...:  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 5/7 [00:03<00:01,  1.41it/s]{'force_upcast', 'scaling_factor'} was not found in config. Values will be initialized to default values.
Loading pipeline components...: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:04<00:00,  1.69it/s]
Loading pipeline components...: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:04<00:00,  1.64it/s]
Loading pipeline components...: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:04<00:00,  1.69it/s]
[34m[1mwandb[39m[22m: [33mWARNING[39m (User provided step: 2 is less than current step: 15. Dropping entry: {'train_loss': 0.04684998746961355, '_timestamp': 1705633596.2558627}).█████████████████████████████████| 7/7 [00:04<00:00,  1.69it/s]
 Generating 1 images with prompt: Transform the text in the image into Anny's style with a white background..8746961355, '_timestamp': 1705633596.2558627}).█████████████████████████████████| 7/7 [00:04<00:00,  1.69it/s]
Loaded scheduler as EulerAncestralDiscreteScheduler from `scheduler` subfolder of timbrooks/instruct-pix2pix.8746961355, '_timestamp': 1705633596.2558627}).█████████████████████████████████| 7/7 [00:04<00:00,  1.69it/s]Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of timbrooks/instruct-pix2pix.
{'timestep_spacing', 'rescale_betas_zero_snr'} was not found in config. Values will be initialized to default values.                                                                                | 0/7 [00:00<?, ?it/s]
Loaded scheduler as EulerAncestralDiscreteScheduler from `scheduler` subfolder of timbrooks/instruct-pix2pix.8746961355, '_timestamp': 1705633596.2558627}).█████████████████████████████████| 7/7 [00:04<00:00,  1.69it/s]Loaded feature_extractor as CLIPImageProcessor from `feature_extractor` subfolder of timbrooks/instruct-pix2pix.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["id2label"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["bos_token_id"]` will be overriden.
`text_config_dict` is provided which will be used to initialize `CLIPTextConfig`. The value `text_config["eos_token_id"]` will be overriden.
Loaded safety_checker as StableDiffusionSafetyChecker from `safety_checker` subfolder of timbrooks/instruct-pix2pix.
                                                                                                                                                                                                                           Loaded text_encoder as CLIPTextModel from `text_encoder` subfolder of timbrooks/instruct-pix2pix.
Loading pipeline components...:  57%|██████████████████████████████████████████████████████████████████████████████████████▊                                                                 | 4/7 [00:01<00:01,  2.53it/s]Loaded tokenizer as CLIPTokenizer from `tokenizer` subfolder of timbrooks/instruct-pix2pix.
{'force_upcast', 'scaling_factor'} was not found in config. Values will be initialized to default values.████████████████████████████████████████▌                                           | 5/7 [00:02<00:00,  2.05it/s]
Loaded vae as AutoencoderKL from `vae` subfolder of timbrooks/instruct-pix2pix.
Loading pipeline components...: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.46it/s]
Loading pipeline components...: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7/7 [00:02<00:00,  2.57it/s]
Potential NSFW content was detected in one or more images. A black image will be returned instead. Try again with a different prompt and/or seed.████████████████████████████████████████████| 7/7 [00:02<00:00,  2.57it/s]
    ema_unet.store(unet.parameters())n one or more images. A black image will be returned instead. Try again with a different prompt and/or seed.████████████████████████████████████████████| 7/7 [00:02<00:00,  2.57it/s]
  File "C:\Users\30661\.conda\envs\torchgpu\lib\site-packages\diffusers\training_utils.py", line 363, in store
    self.temp_stored_params = [param.detach().cpu().clone() for param in parameters]
  File "C:\Users\30661\.conda\envs\torchgpu\lib\site-packages\diffusers\training_utils.py", line 363, in <listcomp>
    self.temp_stored_params = [param.detach().cpu().clone() for param in parameters]
KeyboardInterrupt
    ema_unet.store(unet.parameters())n one or more images. A black image will be returned instead. Try again with a different prompt and/or seed.████████████████████████████████████████████| 7/7 [00:02<00:00,  2.57it/s]